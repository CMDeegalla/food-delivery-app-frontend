<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Order History - FoodGo</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<style>
  .iphone {
    width: 390px;
    height: 844px;
    border-radius: 40px;
    overflow: hidden;
    border: 2px solid black;
  }
</style>
</head>

<body class="bg-gray-200 flex justify-center items-center h-screen">

<div class="iphone bg-white relative">

  <!-- HEADER -->
  <div class="bg-gray-700 h-28 flex items-center justify-between px-5">
    <button onclick="history.back()"
            class="bg-white w-10 h-10 rounded-full shadow flex items-center justify-center">
      <span class="material-icons text-gray-700">arrow_back</span>
    </button>

    <h2 class="text-white text-lg font-semibold">Order History</h2>
    <button onclick="clearOrders()"
            class="bg-white w-10 h-10 rounded-full shadow flex items-center justify-center">
      <span class="material-icons text-gray-700">delete</span>
    </button>
  </div>

  <!-- LIST -->
  <div class="px-6 pt-6 pb-28 space-y-4 overflow-y-auto h-[716px]" id="orderList">
    <!-- Orders injected here -->
  </div>

  <!-- BUTTON (Demo add) -->
  <div class="absolute bottom-10 w-full px-6">
    <button onclick="addDemoOrder()"
            class="w-full bg-orange-500 text-white py-4 rounded-xl text-sm font-semibold active:scale-95">
      Add Demo Order
    </button>
  </div>

</div>

<script>
  const ORDERS_KEY = "foodgo_orders";

  function getOrders() {
    const saved = localStorage.getItem(ORDERS_KEY);
    return saved ? JSON.parse(saved) : [];
  }

  function saveOrders(orders) {
    localStorage.setItem(ORDERS_KEY, JSON.stringify(orders));
  }

  function renderOrders() {
    const orders = getOrders();
    const list = document.getElementById("orderList");
    list.innerHTML = "";

    if (!orders.length) {
      list.innerHTML = `
        <div class="text-center mt-10 text-gray-500">
          <span class="material-icons text-5xl">receipt_long</span>
          <p class="mt-3 text-sm">No orders yet.</p>
          <p class="text-xs">Click "Add Demo Order" to test.</p>
        </div>
      `;
      return;
    }

    orders.slice().reverse().forEach(order => {
      const card = document.createElement("div");
      card.className = "bg-gray-100 rounded-2xl p-4 shadow-sm";

      card.innerHTML = `
        <div class="flex justify-between items-start">
          <div>
            <p class="text-sm font-semibold text-gray-800">${order.restaurant}</p>
            <p class="text-xs text-gray-500 mt-1">${order.date}</p>
          </div>
          <span class="text-xs px-3 py-1 rounded-full ${
            order.status === "Delivered" ? "bg-green-100 text-green-700" :
            order.status === "Cancelled" ? "bg-red-100 text-red-700" :
            "bg-yellow-100 text-yellow-700"
          }">${order.status}</span>
        </div>

        <div class="mt-3 text-sm text-gray-700">
          <p><span class="font-medium">Items:</span> ${order.items.join(", ")}</p>
          <p class="mt-1"><span class="font-medium">Total:</span> $${order.total.toFixed(2)}</p>
        </div>

        <button class="mt-3 text-sm text-orange-600 font-semibold"
                onclick="viewOrder('${order.id}')">
          View Details
        </button>
      `;
      list.appendChild(card);
    });
  }

  function addDemoOrder() {
    const orders = getOrders();
    const newOrder = {
      id: "ORD" + Math.floor(Math.random() * 100000),
      restaurant: ["Pizza Hub", "Sushi Town", "Burger Lab", "Taco Zone"][Math.floor(Math.random() * 4)],
      items: ["1x Fries", "1x Burger", "1x Coke"].sort(() => 0.5 - Math.random()).slice(0, 2),
      total: Math.random() * 40 + 10,
      date: new Date().toLocaleString(),
      status: ["Delivered", "Preparing", "Cancelled"][Math.floor(Math.random() * 3)]
    };
    orders.push(newOrder);
    saveOrders(orders);
    renderOrders();
  }

  function viewOrder(orderId) {
    const orders = getOrders();
    const order = orders.find(o => o.id === orderId);
    if (!order) return;

    alert(
      `Order ID: ${order.id}\n` +
      `Restaurant: ${order.restaurant}\n` +
      `Items: ${order.items.join(", ")}\n` +
      `Total: $${order.total.toFixed(2)}\n` +
      `Status: ${order.status}\n` +
      `Date: ${order.date}`
    );
  }

  function clearOrders() {
    if (!confirm("Clear all order history?")) return;
    localStorage.removeItem(ORDERS_KEY);
    renderOrders();
  }

  renderOrders();
</script>

</body>
</html>
